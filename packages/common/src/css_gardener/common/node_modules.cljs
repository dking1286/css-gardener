(ns css-gardener.common.node-modules
  (:require [path]))

(defn root-module-path
  "Constructs the absolute path to a node module installed in the working
   directory of the node process.
   
   This is necessary because css-gardener/core needs to be able to require
   other node modules installed at the root of the project, for resolver and
   transformer plugins. However, it cannot list these plugins as peer
   dependencies, because it cannot know in advance which plugins the user wants
   to use.
   
   Just doing (js/require \"plugin_name\") in css-gardener/core would lead to
   an import error, because node would look in the dependencies of 
   css-gardener/core for the plugin, not the dependencies of the project
   css-gardener/core is installed in. So,
   (js/require \"/path/to/project/node_modules/plugin_name\") is needed
   instead."
  [name]
  (path/resolve "node_modules" name))